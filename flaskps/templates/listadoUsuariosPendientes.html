{% extends "tablaLayout.html" %}

{% set encabezado = 'Listado de Usuarios Pendientes'  %}

{% block cuerpo %}

<div class="container">

        <br>
        <div class="table-responsive">
        <select id="select">
          <option>ID</option>
          <option>Nombre</option>
          <option>Apellido</option>
          <option>DNI</option>
          <option>Estado</option>
        </select>
        <table id="example" class="table table-striped table-bordered table-sm dt-responsive" >
          <thead>
            <tr>
              <th class="th-sm">ID</th>
              <th class="th-sm">Nombre</th>
              <th class="th-sm">Apellido</th>
              <th class="th-sm">Nombre Usuario</th>
              <th class="th-sm">Mail</th>
              <th class="th-sm">Ver perfil</th>
              <th class="th-sm">Eliminar</th>
              <th class="th-sm">Ver</th>
            </tr>
          </thead>
          <tbody>
            {% for elem in users %}
            <tr>
              <td>{{elem.id}}</td>
              <td>{{elem.nombre_u}}</td>
              <td>{{elem.apellido}}</td>
              <td>{{elem.user_name}}</td>
              <td>{{elem.mail_u}}</td>
              <td align="center"><button style="width:85px" type="button" class="btn btn-info" onclick="window.location.href='{{ url_for( 'user_profile' , idUser=elem.id) }}';">Ver</button></td>
              <td align="center"><button type="button" class="btn btn-success" onclick="accept({{elem.id}}, 1,'{{ elem.nombre | upper }}')">Aceptar</button></td>
              <td align="center"><button style="width:85px" type="button" class="btn btn-danger" onclick="reject({{elem.id}}, 2,'{{ elem.nombre | upper }}')">Rechazar</button></td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        </div>
        </div>
  <br>    
{% endblock %}

{% block scripts %} {{super()}} 
<script>
            function accept(id , rol, nombre){
              $.confirm({
                type:'green',
                title: 'Aceptar usuario',
                content: 'Convertir a ' +nombre,
                buttons: {
                    Confirmar: function () {
                      $.ajax({url: "{{ url_for('usuario_actualizar_estado', rol='' ) }}"+ rol + '&idUser=' + id  , success: function(result){
                        $.alert({
                          title: 'Mensaje informativo',
                          content:  'El usuario ahora es del sistema' ,
                          type: ('green'),
                          buttons:{Ok:function(){location.reload()}}
                        });
                      }});
                    },
                    Cancelar: function () {
                        null
                    },
                }
            })             
            };
        function reject(id , rol, nombre){
        console.log(nombre)
        $.confirm({
          type:'red',
          title: 'Rechazar usuario',
          content: 'Rechazar a ' +nombre,
          buttons: {
              Confirmar: function () {
                $.ajax({url: "{{ url_for('usuario_actualizar_estado', rol='' ) }}"+rol + '&idUser=' + id  , success: function(result){
                  $.alert({
                    title: 'Mensaje informativo',
                    content:  'El usuario fue rechazado del sistema' ,
                    type: ('red'),
                    buttons:{Ok:function(){location.reload()}}
                  });  
                }});
              },
              Cancelar: function () {
                  null
              },
          }
      })             
      };    
</script>


{% endblock %}








