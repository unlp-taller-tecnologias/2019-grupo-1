{% extends "layout.html" %}

{% set encabezado = 'Perfil Comedor' %}

{% block styles %}
  {{ super() }}
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
  integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
  crossorigin=""/>
  
{% endblock %}

  {% block cuerpo %}
    <div id="map" style="height:500px"></div>
  {% endblock %} 

{% block scripts %}
    {{ super() }}
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
    integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
    crossorigin=""></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <script>
    
        var getUrlParameter = function getUrlParameter(sParam) {
          var sPageURL = window.location.search.substring(1),
              sURLVariables = sPageURL.split('&'),
              sParameterName,
              i;
      
          for (i = 0; i < sURLVariables.length; i++) {
              sParameterName = sURLVariables[i].split('=');
      
              if (sParameterName[0] === sParam) {
                  return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
              }
          }
      };

    let id= getUrlParameter('idComedor');
    $.ajax({url: "{{ url_for('mapInfoOne', id='' ) }}"+id, success: function(result){
      var comedor= result['comedor']
      console.log(comedor)
      var latlng = L.latLng([comedor['latitud'], comedor['longitud']]);
      console.log(latlng)
      var mymap = L.map('map',{
        center: latlng,
        zoom: 15,
        maxZoom: 18,
        minZoom: 8
      });
  
      L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
          '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
          'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
        id: 'mapbox.streets'
      }).addTo(mymap);

      L.marker(latlng,{title: comedor['nombre']})
        .addTo(mymap)
        .bindPopup('<b>'+ comedor['nombre'].toUpperCase() +'</b>')
        .openPopup();
       
    }});
              
  </script>
  
{% endblock %}


